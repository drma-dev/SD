@using SD.WEB.Modules.Profile.Components
@inherits ComponenteCore<MyWishListPopup>

<ModalHeader>
    <ModalTitle Size="HeadingSize.Is5">@Title.Format(LocalQuantity)</ModalTitle>
    <CloseButton />
</ModalHeader>
<ModalBody MaxHeight="70">
    <Wishlist MediaType="MediaType" Private="true" ShowHeader="false" FullScreen="true"></Wishlist>
</ModalBody>
<ModalFooter>
    <Button Color="Color.Secondary" Clicked="@ModalService.Hide" Size="Size.Small">@TranslationText.Close</Button>
</ModalFooter>

@code {
    [Inject] public IModalService ModalService { get; set; } = default!;

    [Parameter] public MediaType MediaType { get; set; }
    [Parameter] public int Quantity { get; set; }

    private string Title => MediaType == MediaType.movie ? GlobalTranslations.MyMovieWishlist : GlobalTranslations.MyShowWishlist;
    public int LocalQuantity { get; set; }

    protected override void OnInitialized()
    {
        LocalQuantity = Quantity;
        AppState.WishListChanged += (WishList? list) => { LocalQuantity = MediaType == MediaType.movie ? list?.Movies.Count ?? 0 : list?.Shows.Count ?? 0; StateHasChanged(); };
    }
}
