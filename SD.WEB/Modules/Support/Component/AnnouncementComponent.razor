@using SD.Shared.Models.Support;
@using SD.WEB.Modules.Support.Core;
@inherits ComponenteCore<AnnouncementComponent>
@inject AnnouncementApi AnnouncementApi

<RenderControl Core="Core" Model="announcement" ExpressionEmpty="@((AnnouncementModel? obj) => obj == null || obj.Items.Empty())">
    @foreach (var item in announcement?.Items.OrderByDescending(o => o.Date) ?? Enumerable.Empty<AnnouncementItem>())
    {
        <Alert Color="Color.Info" Visible="true" Margin="Margin.Is2.FromBottom">
            <AlertMessage>
                @item.Title
            </AlertMessage>
        </Alert>
        <Paragraph Margin="Margin.Is2.OnY" TextAlignment="TextAlignment.Justified">
            @((MarkupString)(item.Description ?? ""))
        </Paragraph>        
    }
</RenderControl>

@code {
    public RenderControlCore<AnnouncementModel?> Core { get; set; } = new();
    private AnnouncementModel? announcement;

    protected override async Task LoadDataRender()
    {
        announcement = await AnnouncementApi.Get(Core);
    }
}
